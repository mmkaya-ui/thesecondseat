<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Second Seat | Hunger is cured by food. Isolation by company.</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Config for Brand Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        charcoal: '#2C3E50',
                        terracotta: '#E27D60',
                        cream: '#F9F7F2',
                        stone: '#DCDCDC',
                        green: { 600: '#16a34a' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F9F7F2;
            color: #2C3E50;
            scroll-behavior: smooth;
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeIn {
            to { opacity: 1; transform: translateY(0); }
        }

        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #F9F7F2; }
        ::-webkit-scrollbar-thumb { background: #E27D60; border-radius: 4px; }

        .hero-bg {
            background-image: linear-gradient(rgba(44, 62, 80, 0.7), rgba(44, 62, 80, 0.6)), url('https://images.unsplash.com/photo-1543362906-ac1b452601d8?q=80&w=2000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-charcoal/95 backdrop-blur-sm text-cream border-b border-white/10 transition-all" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 cursor-pointer js-nav-link" data-target="home">
                    <div class="flex items-center gap-3">
                        <svg width="40" height="40" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="25" stroke="#E27D60" stroke-width="3"/>
                            <path d="M50 15 C60 15 65 20 65 25" stroke="#F9F7F2" stroke-width="3" stroke-linecap="round"/>
                            <path d="M50 15 C40 15 35 20 35 25" stroke="#F9F7F2" stroke-width="3" stroke-linecap="round"/>
                            <path d="M50 85 C60 85 65 80 65 75" stroke="#E27D60" stroke-width="3" stroke-linecap="round" stroke-dasharray="4 4"/>
                            <path d="M50 85 C40 85 35 80 35 75" stroke="#E27D60" stroke-width="3" stroke-linecap="round" stroke-dasharray="4 4"/>
                        </svg>
                        <span class="font-serif text-xl font-bold tracking-wider" data-i18n="brandName">The Second Seat</span>
                    </div>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-6">
                    <div class="flex items-baseline space-x-8">
                        <button class="hover:text-terracotta transition-colors px-3 py-2 rounded-md text-sm font-medium js-nav-link" data-target="home" data-i18n="nav.mission">Mission</button>
                        <button class="hover:text-terracotta transition-colors px-3 py-2 rounded-md text-sm font-medium js-nav-link" data-target="directory" data-i18n="nav.find">Find a Seat</button>
                        <button class="bg-terracotta hover:bg-orange-700 text-white px-5 py-2 rounded-full text-sm font-medium transition-all shadow-lg transform hover:-translate-y-0.5 js-nav-link" data-target="register" data-i18n="nav.register">For Restaurants</button>
                    </div>
                    
                    <!-- Login & Language -->
                    <div class="flex items-center gap-4 border-l border-white/20 pl-6" id="lang-switcher">
                        <button class="text-sm font-medium text-gray-300 hover:text-white flex items-center gap-1 js-login-trigger">
                            <i data-lucide="log-in" class="w-4 h-4"></i> <span data-i18n="nav.login">Login</span>
                        </button>
                        <div class="flex gap-2">
                            <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="en">EN</button>
                            <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="de">DE</button>
                            <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="tr">TR</button>
                        </div>
                    </div>
                </div>

                <!-- Mobile menu button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" id="mobile-menu-btn" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i data-lucide="menu" class="h-6 w-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Panel -->
        <div class="md:hidden hidden bg-charcoal border-t border-gray-700" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left js-nav-link" data-target="home" data-i18n="nav.mission">Mission</button>
                <button class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left js-nav-link" data-target="directory" data-i18n="nav.find">Find a Seat</button>
                <button class="text-terracotta font-bold block px-3 py-2 rounded-md text-base w-full text-left js-nav-link" data-target="register" data-i18n="nav.register">Restaurant Sign Up</button>
                <button class="text-gray-300 font-bold block px-3 py-2 rounded-md text-base w-full text-left js-login-trigger" data-i18n="nav.login">Login</button>
                
                <div class="flex gap-4 px-3 py-4 border-t border-gray-700 mt-2" id="mobile-lang-switcher">
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="en">EN</button>
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="de">DE</button>
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="tr">TR</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="pt-20">
        <!-- SECTION: HOME / HERO -->
        <div id="home" class="page-section">
            <div class="relative h-[90vh] flex items-center justify-center hero-bg">
                <div class="relative max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h1 class="font-serif text-5xl md:text-7xl text-cream font-bold leading-tight mb-6 fade-in">
                        <span data-i18n="hero.line1">Hunger is cured by food.</span><br>
                        <span class="text-terracotta italic" data-i18n="hero.line2">Isolation is cured by company.</span>
                    </h1>
                    <p class="mt-4 max-w-2xl mx-auto text-xl text-gray-200 fade-in delay-100 font-light" data-i18n="hero.desc">
                        We bridge the divide. You invite a neighbor in need. You share a meal. The restaurant covers their tab.
                    </p>
                    <div class="mt-10 flex flex-col sm:flex-row gap-4 justify-center fade-in delay-200">
                        <button class="bg-terracotta hover:bg-orange-700 text-white px-8 py-4 rounded-full text-lg font-semibold shadow-lg transition-all flex items-center justify-center gap-2 js-nav-link" data-target="directory">
                            <i data-lucide="utensils"></i> <span data-i18n="cta.find">Find a Table</span>
                        </button>
                        <button class="bg-transparent border-2 border-cream text-cream hover:bg-cream hover:text-charcoal px-8 py-4 rounded-full text-lg font-semibold transition-all flex items-center justify-center gap-2 js-nav-link" data-target="register">
                             <span data-i18n="cta.owner">I Own a Restaurant</span>
                        </button>
                    </div>
                </div>
                <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce text-cream/50">
                    <i data-lucide="chevron-down" class="w-8 h-8"></i>
                </div>
            </div>

            <!-- The Manifesto -->
            <section class="py-24 bg-cream">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                        <div>
                            <span class="text-terracotta font-bold tracking-widest uppercase text-sm" data-i18n="manifesto.label">The Vision</span>
                            <h2 class="font-serif text-4xl text-charcoal font-bold mt-2 mb-6" data-i18n="manifesto.title">More Than a Meal. A Movement.</h2>
                            <p class="text-lg text-gray-600 mb-6 leading-relaxed">
                                <span data-i18n="manifesto.p1">Charity often involves a vertical dynamic—dropping a coin in a cup and walking away.</span> 
                                <strong data-i18n="brandName">The Second Seat</strong> 
                                <span data-i18n="manifesto.p2">is about solidarity. It is a horizontal dynamic.</span>
                            </p>
                            <p class="text-lg text-gray-600 mb-8 leading-relaxed" data-i18n="manifesto.p3">
                                We partner with restaurants to turn unused capacity into dignity. When you bring a homeless or food-insecure guest to a participating venue, you pay for yourself. The restaurant, honoring their pledge, covers your guest. You both leave full.
                            </p>
                            <div class="border-l-4 border-terracotta pl-6 py-2 bg-white/50 rounded-r-lg">
                                <p class="italic text-charcoal font-serif text-xl" data-i18n="manifesto.quote">"The table is the only place where we are not defined by what we have, but by what we share."</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Feature Grid -->
                            <div class="space-y-4 mt-8">
                                <div class="bg-white p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center">
                                    <i data-lucide="armchair" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold text-charcoal" data-i18n="grid.dignity.title">Dignity First</h3>
                                    <p class="text-sm text-gray-500 mt-2" data-i18n="grid.dignity.desc">No separate lines. No special menus. Just dinner.</p>
                                </div>
                                <div class="bg-charcoal p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center text-cream">
                                    <i data-lucide="shield-check" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.impact.title">Verified Impact</h3>
                                    <p class="text-sm text-gray-400 mt-2" data-i18n="grid.impact.desc">Every participating restaurant is vetted and trained.</p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-terracotta p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center text-white">
                                    <i data-lucide="users" class="w-10 h-10 text-white mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.community.title">Community</h3>
                                    <p class="text-sm text-orange-100 mt-2" data-i18n="grid.community.desc">Breaking the walls of social isolation.</p>
                                </div>
                                <div class="bg-white p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center">
                                    <i data-lucide="heart-handshake" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.bill.title">The Invisible Bill</h3>
                                    <p class="text-sm text-gray-500 mt-2" data-i18n="grid.bill.desc">The check never arrives for the guest. It's handled silently.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- SECTION: DIRECTORY -->
        <div id="directory" class="page-section hidden min-h-screen bg-gray-50">
            <div class="bg-charcoal text-cream py-16">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h2 class="font-serif text-4xl font-bold" data-i18n="directory.title">Find a Seat</h2>
                    <p class="mt-4 text-gray-300 max-w-2xl mx-auto" data-i18n="directory.subtitle">Locate participating restaurants nearby. Check the live capacity indicator before you go.</p>
                    
                    <div class="mt-8 flex flex-wrap justify-center gap-4" id="filter-container">
                        <button class="filter-btn active bg-terracotta text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="all" data-i18n="filter.all">All</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Breakfast" data-i18n="filter.breakfast">Breakfast</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Lunch" data-i18n="filter.lunch">Lunch</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Dinner" data-i18n="filter.dinner">Dinner</button>
                    </div>
                </div>
            </div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-8 rounded-r-md flex items-start gap-3">
                    <i data-lucide="info" class="text-blue-500 w-5 h-5 mt-0.5"></i>
                    <div>
                        <p class="text-sm text-blue-800 font-bold" data-i18n="protocol.title">Patron Protocol</p>
                        <p class="text-sm text-blue-700" data-i18n="protocol.desc">Please arrive together. Mention "The Second Seat Reservation" quietly to the host upon arrival.</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="restaurant-grid"></div>
            </div>
        </div>

        <!-- SECTION: REGISTER -->
        <div id="register" class="page-section hidden min-h-screen bg-cream">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col lg:flex-row">
                    <div class="lg:w-1/2 bg-charcoal p-12 text-cream flex flex-col justify-center">
                        <h2 class="font-serif text-4xl font-bold mb-6" data-i18n="register.title">Set the Table.</h2>
                        <p class="text-lg text-gray-300 mb-8" data-i18n="register.subtitle">Join a network of conscious businesses turning empty tables into social impact.</p>
                        <ul class="space-y-6">
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="check" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat1.title">Tax Deductible</h4><p class="text-sm text-gray-400" data-i18n="register.feat1.desc">All meals provided are tracked and certified as charitable contributions.</p></div>
                            </li>
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="shield" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat2.title">Control Your Capacity</h4><p class="text-sm text-gray-400" data-i18n="register.feat2.desc">You set the limit. 2 seats a night or 20. Pause anytime via SMS.</p></div>
                            </li>
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="award" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat3.title">Badge of Honor</h4><p class="text-sm text-gray-400" data-i18n="register.feat3.desc">Receive our window decal and digital badge showing you support the community.</p></div>
                            </li>
                        </ul>
                    </div>

                    <div class="lg:w-1/2 p-12 bg-white">
                        <form id="partnerForm">
                            <h3 class="text-2xl font-bold text-charcoal mb-6" data-i18n="form.title">Application to Register</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.name">Restaurant Name</label>
                                    <input type="text" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta focus:border-transparent outline-none transition-all">
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.manager">Manager Name</label>
                                        <input type="text" name="manager" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.phone">Business Phone</label>
                                        <input type="tel" name="phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.license">Business License #</label>
                                    <input type="text" name="license" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.pledge">Proposed Pledge</label>
                                    <select name="pledge" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                        <option data-i18n="form.opt1">1-5 Seats</option>
                                        <option data-i18n="form.opt2">5-10 Seats</option>
                                        <option data-i18n="form.opt3">10-20 Seats</option>
                                        <option data-i18n="form.opt4">Unlimited</option>
                                    </select>
                                </div>
                                <div class="pt-4">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" required class="w-4 h-4 text-terracotta rounded border-gray-300 focus:ring-terracotta">
                                        <span class="text-sm text-gray-600"><span data-i18n="form.agree">I agree to the </span><a href="#" class="text-terracotta hover:underline" data-i18n="grid.bill.title">Invisible Bill Protocol</a>.</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer mt-2">
                                        <input type="checkbox" required class="w-4 h-4 text-terracotta rounded border-gray-300 focus:ring-terracotta">
                                        <span class="text-sm text-gray-600" data-i18n="form.kvkk">I agree to the processing of personal data (KVKK/GDPR).</span>
                                    </label>
                                </div>
                                <button type="submit" class="w-full bg-charcoal hover:bg-gray-800 text-white font-bold py-3 rounded-lg mt-6 transition-all flex items-center justify-center gap-2">
                                    <span data-i18n="form.submit">Submit Application</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION: DASHBOARD (RESTAURANT PANEL) -->
        <div id="dashboard" class="page-section hidden min-h-screen bg-gray-50">
            <div class="bg-charcoal text-cream py-8">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
                    <div>
                        <h2 class="font-serif text-2xl font-bold" id="dash-restaurant-name">Restaurant Dashboard</h2>
                        <p class="text-sm text-gray-400">Manage your capacity and impact.</p>
                    </div>
                    <button class="text-sm bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-colors js-logout">
                        Logout
                    </button>
                </div>
            </div>

            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- Capacity Card -->
                    <div class="bg-white p-8 rounded-2xl shadow-lg border border-gray-100">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <h3 class="text-lg font-bold text-charcoal mb-1" data-i18n="dash.capacity">Current Availability</h3>
                                <p class="text-sm text-gray-500">Seats available for today</p>
                            </div>
                            <div class="p-3 bg-terracotta/10 rounded-full">
                                <i data-lucide="armchair" class="w-6 h-6 text-terracotta"></i>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-center gap-8 mb-6">
                            <button class="w-12 h-12 rounded-full border-2 border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors js-cap-minus">
                                <i data-lucide="minus" class="w-5 h-5 text-gray-600"></i>
                            </button>
                            <div class="text-center">
                                <span class="block text-5xl font-bold text-charcoal" id="dash-capacity-count">0</span>
                                <span class="text-xs text-gray-400 uppercase tracking-wider">Seats Left</span>
                            </div>
                            <button class="w-12 h-12 rounded-full border-2 border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors js-cap-plus">
                                <i data-lucide="plus" class="w-5 h-5 text-gray-600"></i>
                            </button>
                        </div>

                        <button class="w-full bg-terracotta hover:bg-orange-700 text-white font-bold py-4 rounded-xl shadow-md transition-all flex items-center justify-center gap-2 js-guest-arrived">
                            <i data-lucide="user-check"></i> <span data-i18n="dash.guestBtn">Guest Arrived (Use Seat)</span>
                        </button>
                        <p class="text-xs text-center text-gray-400 mt-3">Pressing this instantly updates the public map.</p>
                    </div>

                    <!-- Status Card -->
                    <div class="bg-white p-8 rounded-2xl shadow-lg border border-gray-100 flex flex-col justify-between">
                        <div>
                            <h3 class="text-lg font-bold text-charcoal mb-4" data-i18n="dash.status">Live Status</h3>
                            <div class="flex items-center gap-3 mb-6">
                                <div class="w-3 h-3 rounded-full bg-green-500 animate-pulse"></div>
                                <span class="text-green-700 font-medium">Online & Visible</span>
                            </div>
                            <div class="border-t border-gray-100 pt-4">
                                <div class="flex justify-between mb-2">
                                    <span class="text-gray-600">Total Pledged</span>
                                    <span class="font-bold">5 / day</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Impact Score</span>
                                    <span class="font-bold text-terracotta" id="dash-impact-score">124 Meals</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg mt-6">
                            <p class="text-sm text-blue-800 italic">"Thank you for being the bridge."</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="bg-charcoal text-white py-12 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0 text-center md:text-left">
                    <h3 class="font-serif text-2xl font-bold text-cream" data-i18n="brandName">The Second Seat</h3>
                    <p class="text-gray-400 mt-2 text-sm" data-i18n="footer.tagline">Building tables, not walls.</p>
                </div>
                <div class="flex space-x-8 text-sm text-gray-400">
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.conduct">Code of Conduct</a>
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.safety">Safety Guidelines</a>
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.contact">Contact</a>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-white/5 text-center text-xs text-gray-500">
                &copy; 2024 The Second Seat Initiative. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- SUCCESS MODAL -->
    <div id="successModal" class="fixed inset-0 z-[60] hidden">
        <!-- Optimized Backdrop (Removed Blur) -->
        <div class="absolute inset-0 bg-charcoal/95 js-close-modal"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="check" class="w-8 h-8 text-green-600"></i>
            </div>
            <h3 class="font-serif text-3xl font-bold text-charcoal mb-2" data-i18n="modal.title">Table Set.</h3>
            <p class="text-gray-600 mb-6" data-i18n="modal.body">You’ve just joined a quiet revolution. By pledging your capacity, you aren't just giving away food; you are reclaiming the public square.</p>
            <p class="text-sm text-gray-500 mb-6" data-i18n="modal.footer">Our verification team will call the number provided within 24 hours.</p>
            <button class="w-full bg-terracotta text-white font-bold py-3 rounded-lg hover:bg-orange-700 transition-colors js-close-modal">
                <span data-i18n="modal.btn">Return to Home</span>
            </button>
        </div>
    </div>

    <!-- LOGIN MODAL -->
    <div id="loginModal" class="fixed inset-0 z-[60] hidden">
        <!-- Optimized Backdrop: Removed 'backdrop-blur-sm' for better performance on input focus -->
        <div class="absolute inset-0 bg-charcoal/95 js-close-login"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full">
            <div class="flex justify-between items-center mb-6">
                <h3 class="font-serif text-2xl font-bold text-charcoal">Restaurant Login</h3>
                <button class="text-gray-400 hover:text-charcoal js-close-login"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            
            <!-- Error Message Container -->
            <div id="loginError" class="hidden mb-4 p-3 bg-red-50 border border-red-200 text-red-600 rounded-lg text-sm flex items-center gap-2">
                <i data-lucide="alert-circle" class="w-4 h-4 flex-shrink-0"></i>
                <span data-i18n="auth.error">Invalid ID or Password.</span>
            </div>

            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Restaurant ID</label>
                    <input type="text" placeholder="" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" placeholder="" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                </div>
                <button type="submit" class="w-full bg-charcoal text-white font-bold py-3 rounded-lg hover:bg-gray-800 transition-colors">
                    Login to Dashboard
                </button>
            </form>
        </div>
    </div>

    <!-- APPLICATION KERNEL -->
    <script>
    /**
     * @fileoverview The Second Seat - Enterprise Grade SPA
     * @version 3.0.0
     * @author Gemini Senior Architect
     * * ARCHITECTURE:
     * 1. Core: DI Container, Event Emitter, Reactive Store
     * 2. Infrastructure: Storage Adapter (Persistence), I18n
     * 3. Domain: Repositories (Data Access)
     * 4. Application: Services (Business Logic)
     * 5. Presentation: Components (View Logic)
     */

    /* =========================================
       0. CONFIGURATION & TYPES
       ========================================= */

    const CONFIG = {
        APP_KEY: 'the_second_seat_v1',
        ADMIN: {
            ID: '001',
            // In a real app, hash this!
            HASH: '19283746Adm1n', 
            NAME: 'Yönetici (Admin)'
        },
        DEFAULT_LANG: 'tr',
        SUPPORTED_LANGS: ['tr', 'en', 'de'],
        DOMAINS: {
            TR: 'ikincisandalye.org',
            DE: 'derzweitestuhl.org',
            EN: 'thesecondstool.org'
        },
        // Replace with your actual Google Apps Script Web App URL
        GOOGLE_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbx_PLACEHOLDER_FOR_YOUR_SCRIPT_ID/exec',
        ANIMATION_DELAY: 50 // ms
    };

    /**
     * @typedef {Object} Restaurant
     * @property {number} id
     * @property {string} name
     * @property {string} cuisine
     * @property {string} location
     * @property {string} type - Breakfast, Lunch, Dinner
     * @property {number} capacity
     * @property {number} maxCapacity
     * @property {number} impactScore
     * @property {string} image
     */

    /* =========================================
       1. CORE INFRASTRUCTURE
       ========================================= */

    /**
     * Pub/Sub Pattern for loosely coupled communication.
     */
    class EventEmitter {
        constructor() { this.events = new Map(); }

        /**
         * @param {string} event 
         * @param {Function} listener 
         */
        on(event, listener) {
            if (!this.events.has(event)) this.events.set(event, []);
            this.events.get(event).push(listener);
        }

        /**
         * @param {string} event 
         * @param {any} payload 
         */
        emit(event, payload) {
            if (this.events.has(event)) {
                this.events.get(event).forEach(listener => listener(payload));
            }
        }
    }

    /**
     * State Management with Proxy for automatic reactivity.
     */
    class ReactiveStore extends EventEmitter {
        constructor(initialState) {
            super();
            this.state = new Proxy(initialState, {
                set: (target, key, value) => {
                    target[key] = value;
                    this.emit('stateChange', { key, value, state: this.state });
                    // Also emit specific key event for granular subscriptions
                    this.emit(`change:${String(key)}`, value);
                    return true;
                }
            });
        }

        get() { return this.state; }
        
        /** @param {Partial<Object>} newState */
        commit(newState) {
            Object.entries(newState).forEach(([key, value]) => {
                this.state[key] = value;
            });
        }
    }

    /**
     * Dependency Injection Container.
     */
    class ServiceContainer {
        constructor() { this.services = new Map(); }
        
        register(name, instance) { 
            this.services.set(name, instance);
            return this;
        }
        
        /**
         * @template T
         * @param {string} name 
         * @returns {T}
         */
        get(name) {
            if (!this.services.has(name)) throw new Error(`Service [${name}] not registered.`);
            return this.services.get(name);
        }
    }

    /* =========================================
       2. INFRASTRUCTURE ADAPTERS
       ========================================= */

    /**
     * LocalStorage wrapper for persistence.
     */
    class StorageAdapter {
        constructor(namespace = CONFIG.APP_KEY) {
            this.ns = namespace;
        }

        save(key, data) {
            try {
                localStorage.setItem(`${this.ns}:${key}`, JSON.stringify(data));
            } catch (e) {
                console.error('Storage Save Error:', e);
            }
        }

        load(key) {
            try {
                const data = localStorage.getItem(`${this.ns}:${key}`);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                console.error('Storage Load Error:', e);
                return null;
            }
        }
    }

    class I18nService {
        constructor() {
            this.currentLang = CONFIG.DEFAULT_LANG;
            this.dictionary = this._loadDictionary();
        }

        setLanguage(lang) {
            if (this.dictionary[lang]) {
                this.currentLang = lang;
                document.documentElement.lang = lang;
                return true;
            }
            return false;
        }

        t(key) {
            return key.split('.').reduce((obj, k) => obj && obj[k], this.dictionary[this.currentLang]) || key;
        }

        // Expanded Dictionary with corrected texts
        _loadDictionary() {
            return {
                en: {
                    meta: { title: "The Second Seat | Hunger is cured by food. Isolation by company." },
                    brandName: "The Second Seat",
                    nav: { mission: "Mission", find: "Find a Seat", register: "For Restaurants", login: "Login" },
                    auth: { error: "Invalid Restaurant ID or Password." },
                    hero: {
                        line1: "Hunger is cured by food.",
                        line2: "Isolation is cured by company.",
                        desc: "We bridge the divide. You invite a person in need. You share a meal. The restaurant covers their tab."
                    },
                    cta: { find: "Find a Table", owner: "I Own a Restaurant" },
                    manifesto: {
                        label: "The Vision",
                        title: "More Than a Meal. A Movement.",
                        p1: "Charity often involves a vertical dynamic—dropping a coin in a cup and walking away.",
                        p2: "is about solidarity. It is a horizontal dynamic.",
                        p3: "We partner with restaurants to turn unused capacity into dignity. When you bring a homeless or food-insecure guest to a participating venue, you pay for yourself. The restaurant, honoring their pledge, covers your guest. You both leave full.",
                        quote: "The table is the only place where we are not defined by what we have, but by what we share."
                    },
                    grid: {
                        dignity: { title: "Dignity First", desc: "No separate lines. No special menus. Just dinner." },
                        impact: { title: "Verified Impact", desc: "Every participating restaurant is vetted and trained." },
                        community: { title: "Community", desc: "Breaking the walls of social isolation." },
                        bill: { title: "The Invisible Bill", desc: "The check never arrives for the guest. It's handled silently." }
                    },
                    directory: { title: "Find a Seat", subtitle: "Locate participating restaurants nearby. Check the live capacity indicator before you go." },
                    filter: { all: "All", breakfast: "Breakfast", lunch: "Lunch", dinner: "Dinner" },
                    protocol: { title: "Patron Protocol", desc: "Please arrive together. Mention 'The Second Seat Reservation' quietly to the host upon arrival." },
                    register: {
                        title: "Set the Table.",
                        subtitle: "Join a network of conscious businesses turning empty tables into social impact.",
                        feat1: { title: "Tax Deductible", desc: "All meals provided are tracked and certified as charitable contributions." },
                        feat2: { title: "Control Your Capacity", desc: "You set the limit. 2 seats a night or 20. Pause anytime via SMS." },
                        feat3: { title: "Badge of Honor", desc: "Receive our window decal and digital badge showing you support the community." }
                    },
                    form: {
                        title: "Application to Register",
                        name: "Restaurant Name",
                        manager: "Manager Name",
                        phone: "Business Phone",
                        license: "Business License #",
                        pledge: "Proposed Pledge",
                        opt1: "1-5 Seats",
                        opt2: "5-10 Seats",
                        opt3: "10-20 Seats",
                        opt4: "Unlimited",
                        kvkk: "I agree to the processing of personal data (GDPR).",
                        agree: "I agree to the ",
                        submit: "Submit Application"
                    },
                    dash: { capacity: "Current Availability", guestBtn: "Guest Arrived (Use Seat)", status: "Live Status" },
                    footer: { tagline: "Setting the table for solidarity.", conduct: "Code of Conduct", safety: "Safety Guidelines", contact: "Contact" },
                    modal: { title: "Table Set.", body: "You’ve just joined a quiet revolution. By pledging your capacity, you aren't just giving away food; you are reclaiming the public square.", footer: "Our verification team will call the number provided within 24 hours.", btn: "Return to Home" },
                    dynamic: { full: "Full", open: "Open Seats", left: "Left", daily: "Daily 'Second Seats'", directions: "Get Directions" }
                },
                de: {
                    meta: { title: "Der Zweite Stuhl | Hunger stillt man mit Essen. Einsamkeit mit Gesellschaft." },
                    brandName: "Der Zweite Stuhl",
                    nav: { mission: "Mission", find: "Platz finden", register: "Für Restaurants", login: "Anmelden" },
                    auth: { error: "Ungültige Restaurant-ID oder Passwort." },
                    hero: {
                        line1: "Hunger stillt man mit Essen.",
                        line2: "Einsamkeit mit Gesellschaft.",
                        desc: "Wir überbrücken die Kluft. Du lädst einen Menschen in Not ein. Ihr teilt ein Essen. Das Restaurant übernimmt die Rechnung für den Gast."
                    },
                    cta: { find: "Tisch finden", owner: "Für Gastronomen" },
                    manifesto: {
                        label: "Die Vision",
                        title: "Mehr als nur Essen. Eine Bewegung.",
                        p1: "Wohltätigkeit ist oft distanziert – eine Münze im Hut und weitergehen.",
                        p2: "bedeutet Solidarität. Wir begegnen uns auf Augenhöhe.",
                        p3: "Wir arbeiten mit Restaurants zusammen, um freie Plätze in Würde zu verwandeln. Wenn du einen bedürftigen Gast mitbringst, zahlst du für dich selbst. Das Restaurant übernimmt den Gast. Beide gehen satt nach Hause.",
                        quote: "Der Tisch ist der einzige Ort, an dem wir nicht dadurch definiert werden, was wir haben, sondern was wir teilen."
                    },
                    grid: {
                        dignity: { title: "Würde zuerst", desc: "Keine separaten Schlangen. Keine speziellen Menüs. Einfach Abendessen." },
                        impact: { title: "Geprüfte Wirkung", desc: "Jedes teilnehmende Restaurant ist geprüft und geschult." },
                        community: { title: "Gemeinschaft", desc: "Die Mauern der sozialen Isolation durchbrechen." },
                        bill: { title: "Die Unsichtbare Rechnung", desc: "Die Rechnung kommt nie zum Gast. Sie wird lautlos geregelt." }
                    },
                    directory: { title: "Platz finden", subtitle: "Finde teilnehmende Restaurants in der Nähe. Prüfe die Verfügbarkeit bevor du gehst." },
                    filter: { all: "Alle", breakfast: "Frühstück", lunch: "Mittagessen", dinner: "Abendessen" },
                    protocol: { title: "Gast-Protokoll", desc: "Bitte kommen Sie gemeinsam an. Erwähnen Sie leise 'Die Zweite Stuhl Reservierung' beim Empfang." },
                    register: {
                        title: "Deck den Tisch.",
                        subtitle: "Schließe dich einem Netzwerk bewusster Unternehmen an, die leere Tische in sozialen Wandel verwandeln.",
                        feat1: { title: "Steuerlich absetzbar", desc: "Alle bereitgestellten Mahlzeiten werden erfasst und als Spenden bescheinigt." },
                        feat2: { title: "Kontrolle über Kapazität", desc: "Du setzt das Limit. 2 Plätze pro Nacht oder 20. Pausiere jederzeit per SMS." },
                        feat3: { title: "Ehrenzeichen", desc: "Erhalte unseren Fensteraufkleber und das digitale Abzeichen für dein Engagement." }
                    },
                    form: {
                        title: "Registrierungsantrag",
                        name: "Name des Restaurants",
                        manager: "Name des Managers",
                        phone: "Geschäftstelefon",
                        license: "Gewerbeschein #",
                        pledge: "Vorgeschlagene Plätze",
                        opt1: "1-5 Plätze",
                        opt2: "5-10 Plätze",
                        opt3: "10-20 Plätze",
                        opt4: "Unbegrenzt",
                        kvkk: "Ich stimme der Verarbeitung personenbezogener Daten zu (DSGVO).",
                        agree: "Ich stimme dem Protokoll zu: ",
                        submit: "Antrag absenden"
                    },
                    dash: { capacity: "Aktuelle Verfügbarkeit", guestBtn: "Gast ist da (Platz belegen)", status: "Live Status" },
                    footer: { tagline: "Ein Platz für Solidarität.", conduct: "Verhaltenskodex", safety: "Sicherheitsrichtlinien", contact: "Kontakt" },
                    modal: { title: "Tisch gedeckt.", body: "Du hast dich einer stillen Revolution angeschlossen. Mit deiner Zusage verschenkst du nicht nur Essen; du eroberst den öffentlichen Raum zurück.", footer: "Unser Verifizierungsteam wird die angegebene Nummer innerhalb von 24 Stunden anrufen.", btn: "Zurück zur Startseite" },
                    dynamic: { full: "Belegt", open: "Plätze frei", left: "Verfügbar", daily: "Tägliche 'Zweite Stühle'", directions: "Route planen" }
                },
                tr: {
                    meta: { title: "İkinci Sandalye | Açlığın ilacı yemektir. Yalnızlığın ilacı muhabbettir." },
                    brandName: "İkinci Sandalye",
                    nav: { mission: "Misyon", find: "Yer Bul", register: "Restoranlar İçin", login: "Giriş" },
                    auth: { error: "Geçersiz Restoran ID veya Şifre." },
                    hero: {
                        line1: "Açlığın ilacı yemektir.",
                        line2: "Yalnızlığın ilacı muhabbettir.",
                        desc: "Aradaki uçurumu kapatıyoruz. İhtiyaç sahibi bir insanı davet et. Yemeğini paylaş. Misafirin hesabını restoran üstlensin."
                    },
                    cta: { find: "Masa Bul", owner: "Restoran Sahibiyim" },
                    manifesto: {
                        label: "Vizyonumuz",
                        title: "Bir Yemekten Fazlası. Bir Hareket.",
                        p1: "Geleneksel yardım anlayışı genelde dikey, yani üstten aşağı bir ilişkidir; bir tabağa para bırakıp uzaklaşmak gibi.",
                        p2: "ise dayanışmayı esas alır. Bu, eşitler arası, göz hizasında yatay bir ilişkidir.",
                        p3: "Restoranlarla işbirliği yaparak boş masaları haysiyetli bir paylaşıma dönüştürüyoruz. İhtiyaç sahibi bir misafiri getirdiğinde, sen kendi hesabını ödersin. Restoran, sözünü tutarak misafirini ağırlar. İkiniz de tok kalkarsınız.",
                        quote: "Sofralar, sahip olduklarımızla değil, paylaştıklarımızla tanımlandığımız tek yerdir."
                    },
                    grid: {
                        dignity: { title: "Önce Haysiyet", desc: "Ayrı sıra yok. Özel menü yok. Sadece akşam yemeği." },
                        impact: { title: "Onaylı Etki", desc: "Katılan her restoran denetlenmiş ve eğitilmiştir." },
                        community: { title: "Topluluk", desc: "Sosyal izolasyon duvarlarını yıkıyoruz." },
                        bill: { title: "Görünmez Hesap", desc: "Misafir hesabı görmez. Restoran tarafından sessizce halledilir." }
                    },
                    directory: { title: "Yer Bul", subtitle: "Yakındaki katılımcı restoranları bul. Gitmeden önce doluluk durumunu kontrol et." },
                    filter: { all: "Tümü", breakfast: "Kahvaltı", lunch: "Öğle", dinner: "Akşam" },
                    protocol: { title: "Misafir Protokolü", desc: "Lütfen birlikte gelin. Girişte sessizce 'İkinci Sandalye Rezervasyonu' olduğunu belirtin." },
                    register: {
                        title: "Sofrayı Kur.",
                        subtitle: "Boş masaları sosyal faydaya dönüştüren duyarlı işletmeler ağına katıl.",
                        feat1: { title: "Vergiden Düşülebilir", desc: "Sağlanan tüm yemekler takip edilir ve yardım makbuzu olarak sertifikalandırılır." },
                        feat2: { title: "Kapasite Kontrolü", desc: "Sınırı sen koy. Günde 2 sandalye veya 20. SMS ile dilediğin zaman duraklat." },
                        feat3: { title: "Onur Rozeti", desc: "Topluluğa desteğini gösteren vitrin çıkartmanı ve dijital rozetini al." }
                    },
                    form: {
                        title: "Kayıt Başvurusu",
                        name: "Restoran Adı",
                        manager: "Yönetici Adı",
                        phone: "İş Telefonu",
                        license: "İşletme Ruhsat No",
                        pledge: "Önerilen Kapasite",
                        opt1: "1-5 Sandalye",
                        opt2: "5-10 Sandalye",
                        opt3: "10-20 Sandalye",
                        opt4: "Sınırsız",
                        kvkk: "Kişisel verilerin işlenmesini (KVKK) kabul ediyorum.",
                        agree: "Şu protokolü kabul ediyorum: ",
                        submit: "Başvuruyu Gönder"
                    },
                    dash: { capacity: "Anlık Kapasite Durumu", guestBtn: "Misafir Geldi (Kullan)", status: "Canlı Durum" },
                    footer: { tagline: "Dayanışmaya bir sandalye çek", conduct: "Davranış Kuralları", safety: "Güvenlik İlkeleri", contact: "İletişim" },
                    modal: { title: "Masa Hazır.", body: "Sessiz bir devrime katıldın. Kapasiteni paylaşarak sadece yemek vermiyorsun; kamusal alanı geri kazanıyorsun.", footer: "Doğrulama ekibimiz24 saat içinde verilen numarayı arayacaktır.", btn: "Ana Sayfaya Dön" },
                    dynamic: { full: "Dolu", open: "Yer Var", left: "Kaldı", daily: "Günlük 'İkinci Sandalye'", directions: "Yol Tarifi Al" }
                }
            };
        }
    }

    /* =========================================
       3. DOMAIN LAYER (REPOSITORIES)
       ========================================= */

    /**
     * Handles data access and persistence logic.
     */
    class RestaurantRepository {
        /**
         * @param {StorageAdapter} storage 
         */
        constructor(storage) {
            this.storage = storage;
            this.STORAGE_KEY = 'restaurants_v1';
            
            // Seed data if empty
            if (!this.storage.load(this.STORAGE_KEY)) {
                this.storage.save(this.STORAGE_KEY, this._getInitialData());
            }
        }

        getAll() {
            return this.storage.load(this.STORAGE_KEY) || [];
        }

        getById(id) {
            const all = this.getAll();
            return all.find(r => r.id === id);
        }

        updateCapacity(id, change) {
            const all = this.getAll();
            const restaurant = all.find(r => r.id === id);
            
            if (restaurant) {
                let newCap = restaurant.capacity + change;
                if (newCap < 0) newCap = 0;
                if (newCap > restaurant.maxCapacity) newCap = restaurant.maxCapacity;
                
                restaurant.capacity = newCap;
                this.storage.save(this.STORAGE_KEY, all);
                return restaurant;
            }
            return null;
        }

        /**
         * Records a guest arrival: decreases capacity AND increments impact score.
         * @param {number} id 
         */
        recordGuestArrival(id) {
            const all = this.getAll();
            const restaurant = all.find(r => r.id === id);
            
            if (restaurant) {
                // Decrease capacity (min 0)
                if (restaurant.capacity > 0) {
                    restaurant.capacity--;
                }
                
                // Increase impact score
                restaurant.impactScore = (restaurant.impactScore || 0) + 1;
                
                this.storage.save(this.STORAGE_KEY, all);
                return restaurant;
            }
            return null;
        }

        _getInitialData() {
            return [
                { id: 1, name: "The Hearth & Grain", cuisine: "Rustic American", location: "Downtown • 0.8 mi", type: "Dinner", capacity: 3, maxCapacity: 5, impactScore: 124, image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=600&auto=format&fit=crop" },
                { id: 2, name: "Luna's Table", cuisine: "Mediterranean", location: "West End • 2.1 mi", type: "Lunch", capacity: 0, maxCapacity: 4, impactScore: 89, image: "https://images.unsplash.com/photo-1559339352-11d035aa65de?q=80&w=600&auto=format&fit=crop" },
                { id: 3, name: "Early Bird Diner", cuisine: "Breakfast/Brunch", location: "Uptown • 1.5 mi", type: "Breakfast", capacity: 8, maxCapacity: 10, impactScore: 215, image: "https://images.unsplash.com/photo-1554679665-f5537f187268?q=80&w=600&auto=format&fit=crop" },
                { id: 4, name: "Saffron House", cuisine: "Indian Fusion", location: "Market District • 3.0 mi", type: "Dinner", capacity: 2, maxCapacity: 3, impactScore: 42, image: "https://images.unsplash.com/photo-1585937421612-70a008356f36?q=80&w=600&auto=format&fit=crop" },
                { id: 5, name: "Green Leaf Cafe", cuisine: "Organic/Vegan", location: "Arts District • 0.5 mi", type: "Lunch", capacity: 5, maxCapacity: 5, impactScore: 156, image: "https://images.unsplash.com/photo-1466978913421-dad938661248?q=80&w=600&auto=format&fit=crop" }
            ];
        }

        /**
         * Submits application to Google Sheets
         * @param {FormData} formData
         */
        async submitApplication(formData) {
            const data = Object.fromEntries(formData);
            console.log("Submitting to Google Sheets:", data);
            
            // To make this work, replace GOOGLE_SCRIPT_URL in CONFIG with your deployed web app URL
            if (CONFIG.GOOGLE_SCRIPT_URL && !CONFIG.GOOGLE_SCRIPT_URL.includes('PLACEHOLDER')) {
                try {
                    await fetch(CONFIG.GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors', // Important for simple Google Script submissions
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                } catch (error) {
                    console.error("Error submitting to Google Sheets:", error);
                }
            } else {
                console.warn("Google Script URL not configured. Data logged to console only.");
            }
            
            // Simulate delay for UX
            return new Promise(resolve => setTimeout(resolve, 500));
        }
    }

    /* =========================================
       4. APPLICATION LAYER (SERVICES)
       ========================================= */

    class AuthService {
        constructor() {
            this.user = null;
        }

        login(id, password) {
            if (id === CONFIG.ADMIN.ID && password === CONFIG.ADMIN.HASH) {
                this.user = { id: 1, role: 'admin', name: CONFIG.ADMIN.NAME };
                return true;
            }
            return false;
        }

        logout() { this.user = null; }
        getUser() { return this.user; }
        isAuthenticated() { return !!this.user; }
    }

    /* =========================================
       5. PRESENTATION LAYER (COMPONENTS)
       ========================================= */

    class Component {
        constructor(elementId, container) {
            this.el = typeof elementId === 'string' ? document.getElementById(elementId) : elementId;
            this.services = container;
            if (!this.el) console.warn(`Component Root [${elementId}] not found.`);
        }
        mount() {}
        update(state) {}
        
        // Helper to safe select
        $(selector) { return this.el.querySelector(selector); }
        $$(selector) { return this.el.querySelectorAll(selector); }
    }

    class NavbarComponent extends Component {
        mount(store) {
            const handleLangClick = (e) => {
                const btn = e.target.closest('.lang-btn');
                if (btn) store.commit({ lang: btn.dataset.lang });
            };

            const desktopSwitcher = document.getElementById('lang-switcher');
            const mobileSwitcher = document.getElementById('mobile-lang-switcher');
            if (desktopSwitcher) desktopSwitcher.addEventListener('click', handleLangClick);
            if (mobileSwitcher) mobileSwitcher.addEventListener('click', handleLangClick);

            const toggleBtn = document.getElementById('mobile-menu-btn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    document.getElementById('mobile-menu').classList.toggle('hidden');
                });
            }

            // Login Triggers
            document.querySelectorAll('.js-login-trigger').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.getElementById('loginModal').classList.remove('hidden');
                    document.getElementById('mobile-menu').classList.add('hidden');
                });
            });
        }

        update(state) {
            const i18n = this.services.get('i18n');
            
            document.querySelectorAll('[data-i18n^="nav."]').forEach(el => {
                if(!el.closest('#dashboard')) { 
                    el.textContent = i18n.t(el.getAttribute('data-i18n'));
                }
            });
            document.querySelectorAll('[data-i18n="brandName"]').forEach(el => el.textContent = i18n.t("brandName"));

            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.dataset.lang === state.lang) {
                    btn.classList.remove('text-gray-400');
                    btn.classList.add('text-white', 'underline');
                } else {
                    btn.classList.add('text-gray-400');
                    btn.classList.remove('text-white', 'underline');
                }
            });
        }
    }

    class DirectoryComponent extends Component {
        mount(store) {
            this.grid = document.getElementById('restaurant-grid');
            document.getElementById('filter-container').addEventListener('click', (e) => {
                const btn = e.target.closest('.filter-btn');
                if (btn) store.commit({ filter: btn.dataset.filter });
            });
        }

        update(state) {
            // Update Filter Styles
            const i18n = this.services.get('i18n');
            document.querySelectorAll('.filter-btn').forEach(btn => {
                const isActive = btn.dataset.filter === state.filter;
                btn.className = `filter-btn px-6 py-2 rounded-full text-sm font-semibold transition-all cursor-pointer ${
                    isActive ? 'bg-terracotta text-white' : 'bg-white/10 hover:bg-white/20 text-white'
                }`;
                const key = `filter.${btn.dataset.filter.toLowerCase()}`;
                const trans = i18n.t(key);
                if (trans !== key) btn.textContent = trans;
            });

            // Get fresh data from Repository (Local Storage)
            const repo = this.services.get('repo');
            let restaurants = repo.getAll();
            
            if (state.filter !== 'all') {
                restaurants = restaurants.filter(r => r.type === state.filter);
            }
            
            this.renderGrid(restaurants);
        }

        renderGrid(items) {
            const i18n = this.services.get('i18n');
            const t = i18n.t('dynamic');
            
            this.grid.innerHTML = items.map(r => {
                const isFull = r.capacity === 0;
                const capacityPct = (r.capacity / r.maxCapacity) * 100;
                const typeTrans = i18n.t(`filter.${r.type.toLowerCase()}`) || r.type;

                return `
                    <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow border border-gray-100 group">
                        <div class="relative h-48 overflow-hidden">
                            <img src="${r.image}" alt="${r.name}" loading="lazy" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                            <div class="absolute top-4 right-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold text-charcoal shadow-sm">
                                ${typeTrans}
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h3 class="font-serif text-xl font-bold text-charcoal">${r.name}</h3>
                                    <p class="text-sm text-gray-500">${r.cuisine}</p>
                                </div>
                                <div class="flex flex-col items-end">
                                    <span class="text-xs font-semibold ${isFull ? 'text-red-500' : 'text-green-600'} flex items-center gap-1">
                                        <div class="w-2 h-2 rounded-full ${isFull ? 'bg-red-500' : 'bg-green-500'} animate-pulse"></div>
                                        ${isFull ? t.full : t.open}
                                    </span>
                                </div>
                            </div>
                            <div class="mt-4 mb-4">
                                <div class="flex justify-between text-xs text-gray-500 mb-1">
                                    <span>${t.daily}</span>
                                    <span>${r.capacity} / ${r.maxCapacity} ${t.left}</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-terracotta h-2 rounded-full transition-all duration-1000" style="width: ${capacityPct}%"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between mt-6">
                                <span class="text-xs text-gray-400 flex items-center gap-1">
                                    <i data-lucide="map-pin" class="w-3 h-3"></i> ${r.location}
                                </span>
                                <button class="text-terracotta text-sm font-bold hover:underline">${t.directions}</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Performance Optimization: Only scan grid for icons
            if (window.lucide) window.lucide.createIcons({ root: this.grid });
        }
    }

    class StaticContentComponent extends Component {
        update(state) {
            const i18n = this.services.get('i18n');
            const elements = document.querySelectorAll('[data-i18n]:not([data-i18n^="nav."]):not([data-i18n^="filter."])');
            elements.forEach(el => {
                const translation = i18n.t(el.getAttribute('data-i18n'));
                if (typeof translation === 'string' && el.children.length === 0) {
                    el.textContent = translation;
                }
            });
            const title = i18n.t('meta.title');
            if (title && title !== 'meta.title') document.title = title;
        }
    }

    class DashboardComponent extends Component {
        mount(store) {
            // Efficient Event Delegation
            this.el.addEventListener('click', (e) => {
                const auth = this.services.get('auth');
                const repo = this.services.get('repo');
                const user = auth.getUser();

                if (!user) return;

                // Handle Actions
                if(e.target.closest('.js-logout')) {
                    auth.logout();
                    store.commit({ view: 'home' });
                }

                const handleCapUpdate = (change) => {
                    repo.updateCapacity(user.id, change);
                    // Force system-wide update using timestamp
                    store.commit({ _lastUpdate: Date.now() }); 
                };

                const handleGuestArrived = () => {
                    repo.recordGuestArrival(user.id);
                    // Force system-wide update
                    store.commit({ _lastUpdate: Date.now() });
                }

                if(e.target.closest('.js-cap-minus')) handleCapUpdate(-1);
                if(e.target.closest('.js-cap-plus')) handleCapUpdate(1);
                if(e.target.closest('.js-guest-arrived')) handleGuestArrived();
            });
        }

        update(state) {
            const auth = this.services.get('auth');
            const repo = this.services.get('repo');
            const i18n = this.services.get('i18n');
            const user = auth.getUser();

            if (user) {
                const r = repo.getById(user.id);
                // Safe DOM updates
                const nameEl = document.getElementById('dash-restaurant-name');
                const countEl = document.getElementById('dash-capacity-count');
                const impactEl = document.getElementById('dash-impact-score');
                
                if(nameEl) nameEl.textContent = r.name + " Dashboard";
                if(countEl) countEl.textContent = r.capacity;
                if(impactEl) impactEl.textContent = r.impactScore + " Meals";
                
                // Translations
                const t = (sel, key) => {
                    const el = document.querySelector(sel);
                    if(el) el.textContent = i18n.t(key);
                };
                
                t('[data-i18n="dash.capacity"]', "dash.capacity");
                t('[data-i18n="dash.status"]', "dash.status");
                t('[data-i18n="dash.guestBtn"]', "dash.guestBtn");
            }
        }
    }

    class Router {
        constructor() { this.routes = ['home', 'directory', 'register', 'dashboard']; }
        init(store) {
            document.body.addEventListener('click', (e) => {
                const link = e.target.closest('.js-nav-link');
                if (link) {
                    e.preventDefault();
                    store.commit({ view: link.dataset.target });
                }
            });
        }
    }

    class FormManager extends Component {
        mount(store) {
            const form = document.getElementById('partnerForm');
            const modal = document.getElementById('successModal');
            const loginForm = document.getElementById('loginForm');
            const loginModal = document.getElementById('loginModal');
            const loginError = document.getElementById('loginError');
            
            if (form) {
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const repo = this.services.get('repo');
                    // Send to backend
                    await repo.submitApplication(new FormData(form));
                    modal.classList.remove('hidden');
                });
            }

            if (loginForm) {
                // Performance Fix: Only touch DOM if error is actually visible
                loginForm.addEventListener('input', () => {
                    if (!loginError.classList.contains('hidden')) {
                        loginError.classList.add('hidden');
                    }
                });

                loginForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const inputs = loginForm.querySelectorAll('input');
                    const id = inputs[0].value;
                    const pass = inputs[1].value;
                    
                    const auth = this.services.get('auth');
                    if (auth.login(id, pass)) {
                        loginModal.classList.add('hidden');
                        loginError.classList.add('hidden');
                        store.commit({ view: 'dashboard' });
                        loginForm.reset();
                    } else {
                        loginError.classList.remove('hidden');
                        // REMOVED: window.lucide.createIcons() call.
                        // Optimization: Icons inside the error message are already rendered in the DOM.
                        // We just toggle visibility via CSS, no need to re-scan the entire document.
                    }
                });
            }

            // Close Modals Delegation
            document.body.addEventListener('click', (e) => {
                if (e.target.closest('.js-close-modal')) {
                    modal.classList.add('hidden');
                    store.commit({ view: 'home' });
                    if(form) form.reset();
                }
                if (e.target.closest('.js-close-login')) {
                    loginModal.classList.add('hidden');
                    loginError.classList.add('hidden');
                    if(loginForm) loginForm.reset();
                }
            });
        }
    }

    /* =========================================
       6. BOOTSTRAPPER
       ========================================= */

    class App {
        static async init() {
            console.log('Initializing The Second Seat App v3.0 [Architecture: Clean]');

            // 1. Setup DI Container & Infrastructure
            const container = new ServiceContainer();
            container.register('storage', new StorageAdapter());
            container.register('i18n', new I18nService());
            
            // 2. Setup Domain/App Layer
            // Inject Storage into Repo for persistence
            container.register('repo', new RestaurantRepository(container.get('storage')));
            container.register('auth', new AuthService());

            // 3. Logic: Auto Language Detection
            const detectUserLanguage = () => {
                const hostname = window.location.hostname;
                if (hostname.includes(CONFIG.DOMAINS.TR)) return 'tr';
                if (hostname.includes(CONFIG.DOMAINS.DE)) return 'de';
                if (hostname.includes(CONFIG.DOMAINS.EN)) return 'en';
                
                const browserLang = navigator.language || navigator.userLanguage; 
                const shortCode = browserLang.split('-')[0];
                return CONFIG.SUPPORTED_LANGS.includes(shortCode) ? shortCode : CONFIG.DEFAULT_LANG;
            };

            const initialLang = detectUserLanguage();

            // 4. Setup State
            const store = new ReactiveStore({
                lang: initialLang,
                filter: 'all',
                view: 'home',
                _lastUpdate: Date.now() // Timestamp for forcing refreshes
            });

            // 5. Setup Presentation (Components)
            const components = [
                new NavbarComponent('navbar', container),
                new DirectoryComponent('directory', container),
                new StaticContentComponent(document.body, container),
                new FormManager('register', container),
                new DashboardComponent('dashboard', container)
            ];

            const router = new Router();
            router.init(store);

            // 6. Mount
            components.forEach(c => c.mount(store));

            // 7. Reactivity Loop
            store.on('stateChange', ({ key, value, state }) => {
                if (key === 'lang') container.get('i18n').setLanguage(value);
                
                if (key === 'view') {
                    // Optimized View Switching
                    document.querySelectorAll('.page-section').forEach(el => {
                        el.classList.add('hidden');
                        el.classList.remove('fade-in');
                    });
                    const target = document.getElementById(value);
                    if (target) {
                        target.classList.remove('hidden');
                        // Small delay to allow display:block to apply before animation
                        requestAnimationFrame(() => target.classList.add('fade-in'));
                        window.scrollTo(0, 0);
                    }
                    document.getElementById('mobile-menu').classList.add('hidden');
                }

                // Update all components
                components.forEach(c => c.update(state));
            });

            // 8. Ignition
            store.commit({}); 
            container.get('i18n').setLanguage(initialLang);
            components.forEach(c => c.update(store.get()));
            
            // Initial Icon Render
            if (window.lucide) window.lucide.createIcons();

            console.log('App Ready.');
        }
    }

    document.addEventListener('DOMContentLoaded', App.init);
    </script>
</body>
</html>
