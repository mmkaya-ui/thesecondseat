<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Second Seat | Hunger is cured by food. Isolation by company.</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Config for Brand Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        charcoal: '#2C3E50',
                        terracotta: '#E27D60',
                        cream: '#F9F7F2',
                        stone: '#DCDCDC',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F9F7F2;
            color: #2C3E50;
            scroll-behavior: smooth;
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeIn {
            to { opacity: 1; transform: translateY(0); }
        }

        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #F9F7F2; }
        ::-webkit-scrollbar-thumb { background: #E27D60; border-radius: 4px; }

        .hero-bg {
            background-image: linear-gradient(rgba(44, 62, 80, 0.7), rgba(44, 62, 80, 0.6)), url('https://images.unsplash.com/photo-1543362906-ac1b452601d8?q=80&w=2000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-charcoal/95 backdrop-blur-sm text-cream border-b border-white/10 transition-all" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 cursor-pointer js-nav-link" data-target="home">
                    <div class="flex items-center gap-3">
                        <svg width="40" height="40" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="25" stroke="#E27D60" stroke-width="3"/>
                            <path d="M50 15 C60 15 65 20 65 25" stroke="#F9F7F2" stroke-width="3" stroke-linecap="round"/>
                            <path d="M50 15 C40 15 35 20 35 25" stroke="#F9F7F2" stroke-width="3" stroke-linecap="round"/>
                            <path d="M50 85 C60 85 65 80 65 75" stroke="#E27D60" stroke-width="3" stroke-linecap="round" stroke-dasharray="4 4"/>
                            <path d="M50 85 C40 85 35 80 35 75" stroke="#E27D60" stroke-width="3" stroke-linecap="round" stroke-dasharray="4 4"/>
                        </svg>
                        <span class="font-serif text-xl font-bold tracking-wider" data-i18n="brandName">The Second Seat</span>
                    </div>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-6">
                    <div class="flex items-baseline space-x-8">
                        <button class="hover:text-terracotta transition-colors px-3 py-2 rounded-md text-sm font-medium js-nav-link" data-target="home" data-i18n="nav.mission">Mission</button>
                        <button class="hover:text-terracotta transition-colors px-3 py-2 rounded-md text-sm font-medium js-nav-link" data-target="directory" data-i18n="nav.find">Find a Seat</button>
                        <button class="bg-terracotta hover:bg-orange-700 text-white px-5 py-2 rounded-full text-sm font-medium transition-all shadow-lg transform hover:-translate-y-0.5 js-nav-link" data-target="register" data-i18n="nav.register">For Restaurants</button>
                    </div>
                    
                    <!-- Language Switcher -->
                    <div class="flex items-center gap-2 border-l border-white/20 pl-6" id="lang-switcher">
                        <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="en">EN</button>
                        <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="de">DE</button>
                        <button class="text-xs font-bold hover:text-terracotta transition-colors lang-btn" data-lang="tr">TR</button>
                    </div>
                </div>

                <!-- Mobile menu button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" id="mobile-menu-btn" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i data-lucide="menu" class="h-6 w-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Panel -->
        <div class="md:hidden hidden bg-charcoal border-t border-gray-700" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left js-nav-link" data-target="home" data-i18n="nav.mission">Mission</button>
                <button class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left js-nav-link" data-target="directory" data-i18n="nav.find">Find a Seat</button>
                <button class="text-terracotta font-bold block px-3 py-2 rounded-md text-base w-full text-left js-nav-link" data-target="register" data-i18n="nav.register">Restaurant Sign Up</button>
                <div class="flex gap-4 px-3 py-4 border-t border-gray-700 mt-2" id="mobile-lang-switcher">
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="en">EN</button>
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="de">DE</button>
                    <button class="text-sm font-bold text-gray-400 lang-btn" data-lang="tr">TR</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="pt-20">
        <!-- SECTION: HOME / HERO -->
        <div id="home" class="page-section">
            <div class="relative h-[90vh] flex items-center justify-center hero-bg">
                <div class="relative max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h1 class="font-serif text-5xl md:text-7xl text-cream font-bold leading-tight mb-6 fade-in">
                        <span data-i18n="hero.line1">Hunger is cured by food.</span><br>
                        <span class="text-terracotta italic" data-i18n="hero.line2">Isolation is cured by company.</span>
                    </h1>
                    <p class="mt-4 max-w-2xl mx-auto text-xl text-gray-200 fade-in delay-100 font-light" data-i18n="hero.desc">
                        We bridge the divide. You invite a neighbor in need. You share a meal. The restaurant covers their tab.
                    </p>
                    <div class="mt-10 flex flex-col sm:flex-row gap-4 justify-center fade-in delay-200">
                        <button class="bg-terracotta hover:bg-orange-700 text-white px-8 py-4 rounded-full text-lg font-semibold shadow-lg transition-all flex items-center justify-center gap-2 js-nav-link" data-target="directory">
                            <i data-lucide="utensils"></i> <span data-i18n="cta.find">Find a Table</span>
                        </button>
                        <button class="bg-transparent border-2 border-cream text-cream hover:bg-cream hover:text-charcoal px-8 py-4 rounded-full text-lg font-semibold transition-all flex items-center justify-center gap-2 js-nav-link" data-target="register">
                             <span data-i18n="cta.owner">I Own a Restaurant</span>
                        </button>
                    </div>
                </div>
                <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce text-cream/50">
                    <i data-lucide="chevron-down" class="w-8 h-8"></i>
                </div>
            </div>

            <!-- The Manifesto -->
            <section class="py-24 bg-cream">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                        <div>
                            <span class="text-terracotta font-bold tracking-widest uppercase text-sm" data-i18n="manifesto.label">The Vision</span>
                            <h2 class="font-serif text-4xl text-charcoal font-bold mt-2 mb-6" data-i18n="manifesto.title">More Than a Meal. A Movement.</h2>
                            <p class="text-lg text-gray-600 mb-6 leading-relaxed">
                                <span data-i18n="manifesto.p1">Charity often involves a vertical dynamic—dropping a coin in a cup and walking away.</span> 
                                <strong data-i18n="brandName">The Second Seat</strong> 
                                <span data-i18n="manifesto.p2">is about solidarity. It is a horizontal dynamic.</span>
                            </p>
                            <p class="text-lg text-gray-600 mb-8 leading-relaxed" data-i18n="manifesto.p3">
                                We partner with restaurants to turn unused capacity into dignity. When you bring a homeless or food-insecure guest to a participating venue, you pay for yourself. The restaurant, honoring their pledge, covers your guest. You both leave full.
                            </p>
                            <div class="border-l-4 border-terracotta pl-6 py-2 bg-white/50 rounded-r-lg">
                                <p class="italic text-charcoal font-serif text-xl" data-i18n="manifesto.quote">"The table is the only place where we are not defined by what we have, but by what we share."</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Feature Grid -->
                            <div class="space-y-4 mt-8">
                                <div class="bg-white p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center">
                                    <i data-lucide="armchair" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold text-charcoal" data-i18n="grid.dignity.title">Dignity First</h3>
                                    <p class="text-sm text-gray-500 mt-2" data-i18n="grid.dignity.desc">No separate lines. No special menus. Just dinner.</p>
                                </div>
                                <div class="bg-charcoal p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center text-cream">
                                    <i data-lucide="shield-check" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.impact.title">Verified Impact</h3>
                                    <p class="text-sm text-gray-400 mt-2" data-i18n="grid.impact.desc">Every participating restaurant is vetted and trained.</p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-terracotta p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center text-white">
                                    <i data-lucide="users" class="w-10 h-10 text-white mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.community.title">Community</h3>
                                    <p class="text-sm text-orange-100 mt-2" data-i18n="grid.community.desc">Breaking the walls of social isolation.</p>
                                </div>
                                <div class="bg-white p-6 rounded-xl shadow-sm h-48 flex flex-col justify-center items-center text-center">
                                    <i data-lucide="heart-handshake" class="w-10 h-10 text-terracotta mb-3"></i>
                                    <h3 class="font-bold" data-i18n="grid.bill.title">The Invisible Bill</h3>
                                    <p class="text-sm text-gray-500 mt-2" data-i18n="grid.bill.desc">The check never arrives for the guest. It's handled silently.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- SECTION: DIRECTORY -->
        <div id="directory" class="page-section hidden min-h-screen bg-gray-50">
            <div class="bg-charcoal text-cream py-16">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h2 class="font-serif text-4xl font-bold" data-i18n="directory.title">Find a Seat</h2>
                    <p class="mt-4 text-gray-300 max-w-2xl mx-auto" data-i18n="directory.subtitle">Locate participating restaurants nearby. Check the live capacity indicator before you go.</p>
                    
                    <div class="mt-8 flex flex-wrap justify-center gap-4" id="filter-container">
                        <button class="filter-btn active bg-terracotta text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="all" data-i18n="filter.all">All</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Breakfast" data-i18n="filter.breakfast">Breakfast</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Lunch" data-i18n="filter.lunch">Lunch</button>
                        <button class="filter-btn bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full text-sm font-semibold transition-all" data-filter="Dinner" data-i18n="filter.dinner">Dinner</button>
                    </div>
                </div>
            </div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-8 rounded-r-md flex items-start gap-3">
                    <i data-lucide="info" class="text-blue-500 w-5 h-5 mt-0.5"></i>
                    <div>
                        <p class="text-sm text-blue-800 font-bold" data-i18n="protocol.title">Patron Protocol</p>
                        <p class="text-sm text-blue-700" data-i18n="protocol.desc">Please arrive together. Mention "The Second Seat Reservation" quietly to the host upon arrival.</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="restaurant-grid"></div>
            </div>
        </div>

        <!-- SECTION: REGISTER -->
        <div id="register" class="page-section hidden min-h-screen bg-cream">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col lg:flex-row">
                    <div class="lg:w-1/2 bg-charcoal p-12 text-cream flex flex-col justify-center">
                        <h2 class="font-serif text-4xl font-bold mb-6" data-i18n="register.title">Set the Table.</h2>
                        <p class="text-lg text-gray-300 mb-8" data-i18n="register.subtitle">Join a network of conscious businesses turning empty tables into social impact.</p>
                        <ul class="space-y-6">
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="check" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat1.title">Tax Deductible</h4><p class="text-sm text-gray-400" data-i18n="register.feat1.desc">All meals provided are tracked and certified as charitable contributions.</p></div>
                            </li>
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="shield" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat2.title">Control Your Capacity</h4><p class="text-sm text-gray-400" data-i18n="register.feat2.desc">You set the limit. 2 seats a night or 20. Pause anytime via SMS.</p></div>
                            </li>
                            <li class="flex items-start gap-4">
                                <div class="bg-white/10 p-2 rounded-full"><i data-lucide="award" class="w-5 h-5 text-terracotta"></i></div>
                                <div><h4 class="font-bold" data-i18n="register.feat3.title">Badge of Honor</h4><p class="text-sm text-gray-400" data-i18n="register.feat3.desc">Receive our window decal and digital badge showing you support the community.</p></div>
                            </li>
                        </ul>
                    </div>

                    <div class="lg:w-1/2 p-12 bg-white">
                        <form id="partnerForm">
                            <h3 class="text-2xl font-bold text-charcoal mb-6" data-i18n="form.title">Application to Register</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.name">Restaurant Name</label>
                                    <input type="text" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta focus:border-transparent outline-none transition-all">
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.manager">Manager Name</label>
                                        <input type="text" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.phone">Business Phone</label>
                                        <input type="tel" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.license">Business License #</label>
                                    <input type="text" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="form.pledge">Proposed Pledge</label>
                                    <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-terracotta outline-none">
                                        <option data-i18n="form.opt1">1-5 Seats</option>
                                        <option data-i18n="form.opt2">5-10 Seats</option>
                                        <option data-i18n="form.opt3">10-20 Seats</option>
                                        <option data-i18n="form.opt4">Unlimited</option>
                                    </select>
                                </div>
                                <div class="pt-4">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" required class="w-4 h-4 text-terracotta rounded border-gray-300 focus:ring-terracotta">
                                        <span class="text-sm text-gray-600"><span data-i18n="form.agree">I agree to the </span><a href="#" class="text-terracotta hover:underline" data-i18n="grid.bill.title">Invisible Bill Protocol</a>.</span>
                                    </label>
                                </div>
                                <button type="submit" class="w-full bg-charcoal hover:bg-gray-800 text-white font-bold py-3 rounded-lg mt-6 transition-all flex items-center justify-center gap-2">
                                    <span data-i18n="form.submit">Submit Application</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-charcoal text-white py-12 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0 text-center md:text-left">
                    <h3 class="font-serif text-2xl font-bold text-cream" data-i18n="brandName">The Second Seat</h3>
                    <p class="text-gray-400 mt-2 text-sm" data-i18n="footer.tagline">Building tables, not walls.</p>
                </div>
                <div class="flex space-x-8 text-sm text-gray-400">
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.conduct">Code of Conduct</a>
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.safety">Safety Guidelines</a>
                    <a href="#" class="hover:text-terracotta transition-colors" data-i18n="footer.contact">Contact</a>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-white/5 text-center text-xs text-gray-500">
                &copy; 2024 The Second Seat Initiative. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- SUCCESS MODAL -->
    <div id="successModal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-charcoal/80 backdrop-blur-sm js-close-modal"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="check" class="w-8 h-8 text-green-600"></i>
            </div>
            <h3 class="font-serif text-3xl font-bold text-charcoal mb-2" data-i18n="modal.title">Table Set.</h3>
            <p class="text-gray-600 mb-6" data-i18n="modal.body">You’ve just joined a quiet revolution. By pledging your capacity, you aren't just giving away food; you are reclaiming the public square.</p>
            <p class="text-sm text-gray-500 mb-6" data-i18n="modal.footer">Our verification team will call the number provided within 24 hours.</p>
            <button class="w-full bg-terracotta text-white font-bold py-3 rounded-lg hover:bg-orange-700 transition-colors js-close-modal">
                <span data-i18n="modal.btn">Return to Home</span>
            </button>
        </div>
    </div>

    <!-- APPLICATION KERNEL -->
    <script>
    /**
     * @fileoverview The Second Seat - Enterprise Grade SPA Architecture
     * @version 2.1.0
     * @description Implements reactive state management, dependency injection, component-based UI
     * and automatic locale detection.
     */

    /* =========================================
       CORE INFRASTRUCTURE
       ========================================= */

    /**
     * @class EventEmitter
     * @description Pub/Sub implementation for decoupled communication.
     */
    class EventEmitter {
        constructor() {
            this.events = {};
        }

        on(event, listener) {
            if (!this.events[event]) this.events[event] = [];
            this.events[event].push(listener);
        }

        emit(event, payload) {
            if (this.events[event]) {
                this.events[event].forEach(listener => listener(payload));
            }
        }
    }

    /**
     * @class ReactiveStore
     * @description State management using Proxy for automatic reactivity.
     */
    class ReactiveStore extends EventEmitter {
        constructor(initialState) {
            super();
            this.state = new Proxy(initialState, {
                set: (target, key, value) => {
                    target[key] = value;
                    this.emit('stateChange', { key, value, state: this.state });
                    return true;
                }
            });
        }

        get() { return this.state; }
        
        /**
         * @param {Partial<Object>} newState 
         */
        commit(newState) {
            Object.assign(this.state, newState);
        }
    }

    /**
     * @class ServiceContainer
     * @description Simple Dependency Injection container.
     */
    class ServiceContainer {
        constructor() {
            this.services = new Map();
        }

        register(name, instance) {
            this.services.set(name, instance);
        }

        get(name) {
            if (!this.services.has(name)) throw new Error(`Service ${name} not found`);
            return this.services.get(name);
        }
    }

    /* =========================================
       SERVICES
       ========================================= */

    class I18nService {
        constructor() {
            this.currentLang = 'tr';
            this.dictionary = this._loadDictionary();
        }

        setLanguage(lang) {
            if (this.dictionary[lang]) {
                this.currentLang = lang;
                document.documentElement.lang = lang;
                return true;
            }
            return false;
        }

        t(key) {
            return key.split('.').reduce((obj, k) => obj && obj[k], this.dictionary[this.currentLang]) || key;
        }

        _loadDictionary() {
            return {
                en: {
                    brandName: "The Second Seat",
                    nav: { mission: "Mission", find: "Find a Seat", register: "For Restaurants" },
                    hero: {
                        line1: "Hunger is cured by food.",
                        line2: "Isolation is cured by company.",
                        desc: "We bridge the divide. You invite a person in need. You share a meal. The restaurant covers their tab."
                    },
                    cta: { find: "Find a Table", owner: "I Own a Restaurant" },
                    manifesto: {
                        label: "The Vision",
                        title: "More Than a Meal. A Movement.",
                        p1: "Charity often involves a vertical dynamic—dropping a coin in a cup and walking away.",
                        p2: "is about solidarity. It is a horizontal dynamic.",
                        p3: "We partner with restaurants to turn unused capacity into dignity. When you bring a homeless or food-insecure guest to a participating venue, you pay for yourself. The restaurant, honoring their pledge, covers your guest. You both leave full.",
                        quote: "The table is the only place where we are not defined by what we have, but by what we share."
                    },
                    grid: {
                        dignity: { title: "Dignity First", desc: "No separate lines. No special menus. Just dinner." },
                        impact: { title: "Verified Impact", desc: "Every participating restaurant is vetted and trained." },
                        community: { title: "Community", desc: "Breaking the walls of social isolation." },
                        bill: { title: "The Invisible Bill", desc: "The check never arrives for the guest. It's handled silently." }
                    },
                    directory: { title: "Find a Seat", subtitle: "Locate participating restaurants nearby. Check the live capacity indicator before you go." },
                    filter: { all: "All", breakfast: "Breakfast", lunch: "Lunch", dinner: "Dinner" },
                    protocol: { title: "Patron Protocol", desc: "Please arrive together. Mention 'The Second Seat Reservation' quietly to the host upon arrival." },
                    register: {
                        title: "Set the Table.",
                        subtitle: "Join a network of conscious businesses turning empty tables into social impact.",
                        feat1: { title: "Tax Deductible", desc: "All meals provided are tracked and certified as charitable contributions." },
                        feat2: { title: "Control Your Capacity", desc: "You set the limit. 2 seats a night or 20. Pause anytime via SMS." },
                        feat3: { title: "Badge of Honor", desc: "Receive our window decal and digital badge showing you support the community." }
                    },
                    form: {
                        title: "Application to Register",
                        name: "Restaurant Name",
                        manager: "Manager Name",
                        phone: "Business Phone",
                        license: "Business License #",
                        pledge: "Proposed Pledge",
                        opt1: "1-5 Seats",
                        opt2: "5-10 Seats",
                        opt3: "10-20 Seats",
                        opt4: "Unlimited",
                        agree: "I agree to the ",
                        submit: "Submit Application"
                    },
                    footer: {
                        tagline: "Building tables, not walls.",
                        conduct: "Code of Conduct",
                        safety: "Safety Guidelines",
                        contact: "Contact"
                    },
                    modal: {
                        title: "Table Set.",
                        body: "You’ve just joined a quiet revolution. By pledging your capacity, you aren't just giving away food; you are reclaiming the public square.",
                        footer: "Our verification team will call the number provided within 24 hours.",
                        btn: "Return to Home"
                    },
                    dynamic: { full: "Full", open: "Open Seats", left: "Left", daily: "Daily 'Second Seats'", directions: "Get Directions" }
                },
                de: {
                    brandName: "Der Zweite Stuhl",
                    nav: { mission: "Mission", find: "Platz finden", register: "Für Restaurants" },
                    hero: {
                        line1: "Hunger stillt man mit Essen.",
                        line2: "Einsamkeit mit Gesellschaft.",
                        desc: "Wir überbrücken die Kluft. Du lädst einen Menschen in Not ein. Ihr teilt ein Essen. Das Restaurant übernimmt die Rechnung für den Gast."
                    },
                    cta: { find: "Tisch finden", owner: "Für Gastronomen" },
                    manifesto: {
                        label: "Die Vision",
                        title: "Mehr als nur Essen. Eine Bewegung.",
                        p1: "Wohltätigkeit ist oft distanziert – eine Münze im Hut und weitergehen.",
                        p2: "bedeutet Solidarität. Wir begegnen uns auf Augenhöhe.",
                        p3: "Wir arbeiten mit Restaurants zusammen, um freie Plätze in Würde zu verwandeln. Wenn du einen bedürftigen Gast mitbringst, zahlst du für dich selbst. Das Restaurant übernimmt den Gast. Beide gehen satt nach Hause.",
                        quote: "Der Tisch ist der einzige Ort, an dem wir nicht dadurch definiert werden, was wir haben, sondern was wir teilen."
                    },
                    grid: {
                        dignity: { title: "Würde zuerst", desc: "Keine separaten Schlangen. Keine speziellen Menüs. Einfach Abendessen." },
                        impact: { title: "Geprüfte Wirkung", desc: "Jedes teilnehmende Restaurant ist geprüft und geschult." },
                        community: { title: "Gemeinschaft", desc: "Die Mauern der sozialen Isolation durchbrechen." },
                        bill: { title: "Die Unsichtbare Rechnung", desc: "Die Rechnung kommt nie zum Gast. Sie wird lautlos geregelt." }
                    },
                    directory: { title: "Platz finden", subtitle: "Finde teilnehmende Restaurants in der Nähe. Prüfe die Verfügbarkeit bevor du gehst." },
                    filter: { all: "Alle", breakfast: "Frühstück", lunch: "Mittagessen", dinner: "Abendessen" },
                    protocol: { title: "Gast-Protokoll", desc: "Bitte kommen Sie gemeinsam an. Erwähnen Sie leise 'Die Zweite Stuhl Reservierung' beim Empfang." },
                    register: {
                        title: "Deck den Tisch.",
                        subtitle: "Schließe dich einem Netzwerk bewusster Unternehmen an, die leere Tische in sozialen Wandel verwandeln.",
                        feat1: { title: "Steuerlich absetzbar", desc: "Alle bereitgestellten Mahlzeiten werden erfasst und als Spenden bescheinigt." },
                        feat2: { title: "Kontrolle über Kapazität", desc: "Du setzt das Limit. 2 Plätze pro Nacht oder 20. Pausiere jederzeit per SMS." },
                        feat3: { title: "Ehrenzeichen", desc: "Erhalte unseren Fensteraufkleber und das digitale Abzeichen für dein Engagement." }
                    },
                    form: {
                        title: "Registrierungsantrag",
                        name: "Name des Restaurants",
                        manager: "Name des Managers",
                        phone: "Geschäftstelefon",
                        license: "Gewerbeschein #",
                        pledge: "Vorgeschlagene Plätze",
                        opt1: "1-5 Plätze",
                        opt2: "5-10 Plätze",
                        opt3: "10-20 Plätze",
                        opt4: "Unbegrenzt",
                        agree: "Ich stimme dem Protokoll zu: ",
                        submit: "Antrag absenden"
                    },
                    footer: {
                        tagline: "Wir bauen Tische, keine Mauern.",
                        conduct: "Verhaltenskodex",
                        safety: "Sicherheitsrichtlinien",
                        contact: "Kontakt"
                    },
                    modal: {
                        title: "Tisch gedeckt.",
                        body: "Du hast dich einer stillen Revolution angeschlossen. Mit deiner Zusage verschenkst du nicht nur Essen; du eroberst den öffentlichen Raum zurück.",
                        footer: "Unser Verifizierungsteam wird die angegebene Nummer innerhalb von 24 Stunden anrufen.",
                        btn: "Zurück zur Startseite"
                    },
                    dynamic: { full: "Belegt", open: "Plätze frei", left: "Verfügbar", daily: "Tägliche 'Zweite Stühle'", directions: "Route planen" }
                },
                tr: {
                    brandName: "İkinci Sandalye",
                    nav: { mission: "Misyon", find: "Yer Bul", register: "Restoranlar İçin" },
                    hero: {
                        line1: "Açlığın ilacı yemektir.",
                        line2: "Yalnızlığın ilacı muhabbettir.",
                        desc: "Aradaki uçurumu kapatıyoruz. İhtiyaç sahibi bir insanı davet et. Yemeğini paylaş. Hesabı restoran üstlensin."
                    },
                    cta: { find: "Masa Bul", owner: "Restoran Sahibiyim" },
                    manifesto: {
                        label: "Vizyonumuz",
                        title: "Bir Yemekten Fazlası. Bir Hareket.",
                        p1: "Yardımseverlik genellikle yukarıdan aşağıyadır—bir sadaka verip uzaklaşmak gibi.",
                        p2: "dayanışmadır. Biz aynı hizada, aynı sofradayız.",
                        p3: "Restoranlarla işbirliği yaparak boş masaları haysiyetli bir paylaşıma dönüştürüyoruz. İhtiyaç sahibi bir misafiri getirdiğinde, sen kendi hesabını ödersin. Restoran, sözünü tutarak misafirini ağırlar. İkiniz de tok kalkarsınız.",
                        quote: "Sofralar, sahip olduklarımızla değil, paylaştıklarımızla tanımlandığımız tek yerdir."
                    },
                    grid: {
                        dignity: { title: "Önce Haysiyet", desc: "Ayrı sıra yok. Özel menü yok. Sadece akşam yemeği." },
                        impact: { title: "Onaylı Etki", desc: "Katılan her restoran denetlenmiş ve eğitilmiştir." },
                        community: { title: "Topluluk", desc: "Sosyal izolasyon duvarlarını yıkıyoruz." },
                        bill: { title: "Görünmez Hesap", desc: "Misafir hesabı görmez. Restoran tarafından sessizce halledilir." }
                    },
                    directory: { title: "Yer Bul", subtitle: "Yakındaki katılımcı restoranları bul. Gitmeden önce doluluk durumunu kontrol et." },
                    filter: { all: "Tümü", breakfast: "Kahvaltı", lunch: "Öğle", dinner: "Akşam" },
                    protocol: { title: "Misafir Protokolü", desc: "Lütfen birlikte gelin. Girişte sessizce 'İkinci Sandalye Rezervasyonu' olduğunu belirtin." },
                    register: {
                        title: "Sofrayı Kur.",
                        subtitle: "Boş masaları sosyal faydaya dönüştüren duyarlı işletmeler ağına katıl.",
                        feat1: { title: "Vergiden Düşülebilir", desc: "Sağlanan tüm yemekler takip edilir ve yardım makbuzu olarak sertifikalandırılır." },
                        feat2: { title: "Kapasite Kontrolü", desc: "Sınırı sen koy. Günde 2 sandalye veya 20. SMS ile dilediğin zaman duraklat." },
                        feat3: { title: "Onur Rozeti", desc: "Topluluğa desteğini gösteren vitrin çıkartmanı ve dijital rozetini al." }
                    },
                    form: {
                        title: "Kayıt Başvurusu",
                        name: "Restoran Adı",
                        manager: "Yönetici Adı",
                        phone: "İş Telefonu",
                        license: "İşletme Ruhsat No",
                        pledge: "Önerilen Kapasite",
                        opt1: "1-5 Sandalye",
                        opt2: "5-10 Sandalye",
                        opt3: "10-20 Sandalye",
                        opt4: "Sınırsız",
                        agree: "Şu protokolü kabul ediyorum: ",
                        submit: "Başvuruyu Gönder"
                    },
                    footer: {
                        tagline: "Duvar değil, sofra kuruyoruz.",
                        conduct: "Davranış Kuralları",
                        safety: "Güvenlik İlkeleri",
                        contact: "İletişim"
                    },
                    modal: {
                        title: "Masa Hazır.",
                        body: "Sessiz bir devrime katıldın. Kapasiteni paylaşarak sadece yemek vermiyorsun; kamusal alanı geri kazanıyorsun.",
                        footer: "Doğrulama ekibimiz 24 saat içinde verilen numarayı arayacaktır.",
                        btn: "Ana Sayfaya Dön"
                    },
                    dynamic: { full: "Dolu", open: "Yer Var", left: "Kaldı", daily: "Günlük 'İkinci Sandalye'", directions: "Yol Tarifi Al" }
                }
            };
        }
    }

    class RestaurantService {
        constructor() {
            this.restaurants = [
                { id: 1, name: "The Hearth & Grain", cuisine: "Rustic American", location: "Downtown • 0.8 mi", type: "Dinner", capacity: 3, maxCapacity: 5, image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=600&auto=format&fit=crop" },
                { id: 2, name: "Luna's Table", cuisine: "Mediterranean", location: "West End • 2.1 mi", type: "Lunch", capacity: 0, maxCapacity: 4, image: "https://images.unsplash.com/photo-1559339352-11d035aa65de?q=80&w=600&auto=format&fit=crop" },
                { id: 3, name: "Early Bird Diner", cuisine: "Breakfast/Brunch", location: "Uptown • 1.5 mi", type: "Breakfast", capacity: 8, maxCapacity: 10, image: "https://images.unsplash.com/photo-1554679665-f5537f187268?q=80&w=600&auto=format&fit=crop" },
                { id: 4, name: "Saffron House", cuisine: "Indian Fusion", location: "Market District • 3.0 mi", type: "Dinner", capacity: 2, maxCapacity: 3, image: "https://images.unsplash.com/photo-1585937421612-70a008356f36?q=80&w=600&auto=format&fit=crop" },
                { id: 5, name: "Green Leaf Cafe", cuisine: "Organic/Vegan", location: "Arts District • 0.5 mi", type: "Lunch", capacity: 5, maxCapacity: 5, image: "https://images.unsplash.com/photo-1466978913421-dad938661248?q=80&w=600&auto=format&fit=crop" }
            ];
        }

        async fetchAll() {
            // Simulate API delay
            return new Promise(resolve => setTimeout(() => resolve(this.restaurants), 50));
        }

        filterByType(type) {
            return type === 'all' 
                ? this.restaurants 
                : this.restaurants.filter(r => r.type === type);
        }
    }

    /* =========================================
       UI ABSTRACTIONS (COMPONENTS)
       ========================================= */

    /**
     * @class Component
     * @description Base component class handling element binding and lifecycle.
     */
    class Component {
        constructor(elementId, container) {
            this.el = typeof elementId === 'string' ? document.getElementById(elementId) : elementId;
            this.services = container;
            if (!this.el) console.warn(`Element not found: ${elementId}`);
        }
        
        // No-op lifecycle hooks
        mount() {}
        update(state) {}
    }

    /**
     * @class NavbarComponent
     * @description Handles navigation and language switching logic.
     */
    class NavbarComponent extends Component {
        mount(store) {
            // Language Switching
            const desktopSwitcher = document.getElementById('lang-switcher');
            const mobileSwitcher = document.getElementById('mobile-lang-switcher');
            
            const handleLangClick = (e) => {
                const btn = e.target.closest('.lang-btn');
                if (btn) store.commit({ lang: btn.dataset.lang });
            };

            if (desktopSwitcher) desktopSwitcher.addEventListener('click', handleLangClick);
            if (mobileSwitcher) mobileSwitcher.addEventListener('click', handleLangClick);

            // Mobile Menu Toggle
            const toggleBtn = document.getElementById('mobile-menu-btn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    const menu = document.getElementById('mobile-menu');
                    menu.classList.toggle('hidden');
                });
            }
        }

        update(state) {
            const i18n = this.services.get('i18n');
            const langBtns = document.querySelectorAll('.lang-btn');
            
            // Hydrate Nav Text
            document.querySelectorAll('[data-i18n^="nav."]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = i18n.t(key);
            });
            
            // Hydrate Brand
            document.querySelectorAll('[data-i18n="brandName"]').forEach(el => {
                el.textContent = i18n.t("brandName");
            });

            // Update Active State
            langBtns.forEach(btn => {
                if (btn.dataset.lang === state.lang) {
                    btn.classList.remove('text-gray-400');
                    btn.classList.add('text-white', 'underline');
                } else {
                    btn.classList.add('text-gray-400');
                    btn.classList.remove('text-white', 'underline');
                }
            });
        }
    }

    /**
     * @class DirectoryComponent
     * @description Manages the restaurant list and filters.
     */
    class DirectoryComponent extends Component {
        mount(store) {
            this.grid = document.getElementById('restaurant-grid');
            const filterContainer = document.getElementById('filter-container');
            
            filterContainer.addEventListener('click', (e) => {
                const btn = e.target.closest('.filter-btn');
                if (btn) store.commit({ filter: btn.dataset.filter });
            });
        }

        async update(state) {
            // Update Filter UI
            document.querySelectorAll('.filter-btn').forEach(btn => {
                const isActive = btn.dataset.filter === state.filter;
                btn.className = `filter-btn px-6 py-2 rounded-full text-sm font-semibold transition-all cursor-pointer ${
                    isActive ? 'bg-terracotta text-white' : 'bg-white/10 hover:bg-white/20 text-white'
                }`;
                // Translate filter button text
                const i18nKey = `filter.${btn.dataset.filter.toLowerCase()}`;
                const translation = this.services.get('i18n').t(i18nKey);
                // Only update if translation exists to avoid clearing static text
                if (translation && translation !== i18nKey) btn.textContent = translation; 
            });

            // Render Grid
            const repo = this.services.get('repo');
            const restaurants = repo.filterByType(state.filter);
            this.renderGrid(restaurants, state.lang);
        }

        renderGrid(items, lang) {
            const i18n = this.services.get('i18n');
            const t = i18n.t('dynamic');
            
            this.grid.innerHTML = items.map(r => {
                const isFull = r.capacity === 0;
                const capacityPct = (r.capacity / r.maxCapacity) * 100;
                const typeKey = `filter.${r.type.toLowerCase()}`;
                const typeTrans = i18n.t(typeKey) || r.type;

                return `
                    <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow border border-gray-100 group">
                        <div class="relative h-48 overflow-hidden">
                            <img src="${r.image}" alt="${r.name}" loading="lazy" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                            <div class="absolute top-4 right-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold text-charcoal shadow-sm">
                                ${typeTrans}
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h3 class="font-serif text-xl font-bold text-charcoal">${r.name}</h3>
                                    <p class="text-sm text-gray-500">${r.cuisine}</p>
                                </div>
                                <div class="flex flex-col items-end">
                                    <span class="text-xs font-semibold ${isFull ? 'text-red-500' : 'text-green-600'} flex items-center gap-1">
                                        <div class="w-2 h-2 rounded-full ${isFull ? 'bg-red-500' : 'bg-green-500'} animate-pulse"></div>
                                        ${isFull ? t.full : t.open}
                                    </span>
                                </div>
                            </div>
                            <div class="mt-4 mb-4">
                                <div class="flex justify-between text-xs text-gray-500 mb-1">
                                    <span>${t.daily}</span>
                                    <span>${r.capacity} / ${r.maxCapacity} ${t.left}</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-terracotta h-2 rounded-full transition-all duration-1000" style="width: ${capacityPct}%"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between mt-6">
                                <span class="text-xs text-gray-400 flex items-center gap-1">
                                    <i data-lucide="map-pin" class="w-3 h-3"></i> ${r.location}
                                </span>
                                <button class="text-terracotta text-sm font-bold hover:underline">${t.directions}</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            if (window.lucide) window.lucide.createIcons();
        }
    }

    /**
     * @class StaticContentComponent
     * @description Hydrates static text elements based on data-i18n attributes.
     */
    class StaticContentComponent extends Component {
        update(state) {
            const i18n = this.services.get('i18n');
            // Select all elements with data-i18n that are NOT nav items (handled by Navbar)
            const elements = document.querySelectorAll('[data-i18n]:not([data-i18n^="nav."]):not([data-i18n^="filter."])');
            
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                const translation = i18n.t(key);
                if (typeof translation === 'string') {
                    // Check if element has child nodes (like icons in buttons)
                    // If it does, we assume the text is in a span or direct text node we should replace carefully.
                    // For simplicity in this architecture, we replace textContent if it's a leaf node or specific wrappers.
                    // However, to be robust for the button icons, we check if it has children.
                    if (el.children.length > 0 && !el.querySelector('span')) {
                        // Complex element, maybe skip or handle specifically?
                        // The 'span' check handles the CTA buttons nicely.
                    } else {
                        el.textContent = translation;
                    }
                }
            });
        }
    }

    /**
     * @class Router
     * @description Simple Hash-based router to manage view visibility.
     */
    class Router {
        constructor() {
            this.routes = ['home', 'directory', 'register'];
            this.currentRoute = 'home';
        }

        init() {
            // Handle initial delegation for navigation links
            document.body.addEventListener('click', (e) => {
                const link = e.target.closest('.js-nav-link');
                if (link) {
                    e.preventDefault();
                    this.navigate(link.dataset.target);
                }
            });
        }

        navigate(routeId) {
            if (!this.routes.includes(routeId)) return;
            
            this.currentRoute = routeId;
            
            // Hide all
            document.querySelectorAll('.page-section').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('fade-in');
            });
            
            // Show target
            const target = document.getElementById(routeId);
            if (target) {
                target.classList.remove('hidden');
                target.classList.add('fade-in');
                window.scrollTo(0, 0);
            }
            
            // Close mobile menu if open
            document.getElementById('mobile-menu').classList.add('hidden');
        }
    }

    /**
     * @class FormManager
     * @description Handles the registration form and success modal logic.
     */
    class FormManager extends Component {
        mount(store) {
            const form = document.getElementById('partnerForm');
            const modal = document.getElementById('successModal');
            
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    modal.classList.remove('hidden');
                });
            }

            // Close Modal Delegation
            document.body.addEventListener('click', (e) => {
                if (e.target.closest('.js-close-modal')) {
                    modal.classList.add('hidden');
                    // Return to home
                    document.getElementById('home').classList.remove('hidden');
                    document.getElementById('register').classList.add('hidden');
                    if(form) form.reset();
                }
            });
        }
    }

    /* =========================================
       APPLICATION BOOTSTRAPPER
       ========================================= */

    class App {
        static async init() {
            console.log('Initializing The Second Seat App v2.1...');

            // 1. Setup DI Container
            const container = new ServiceContainer();
            container.register('i18n', new I18nService());
            container.register('repo', new RestaurantService());

            // ---------------------------------------------------------
            // AUTO-LANGUAGE DETECTION LOGIC (Domain + Browser)
            // ---------------------------------------------------------
            const detectUserLanguage = () => {
                const hostname = window.location.hostname;

                // 1. Domain-based detection
                if (hostname.includes('ikincisandalye.org')) return 'tr';
                if (hostname.includes('derzweitestuhl.org')) return 'de';
                if (hostname.includes('thesecondstool.org')) return 'en';

                // 2. Browser-based fallback
                // Get browser language (e.g., "tr-TR", "de", "en-US")
                const browserLang = navigator.language || navigator.userLanguage; 
                const shortCode = browserLang.split('-')[0]; // "tr-TR" -> "tr"

                // Check against supported languages
                const supportedLanguages = ['tr', 'de'];
                
                // Logic:
                // 1. If user is Turkish (tr), return 'tr'
                // 2. If user is German (de), return 'de'
                // 3. For EVERYONE else (US, UK, India, etc.), default to 'en'
                if (supportedLanguages.includes(shortCode)) {
                    return shortCode;
                }
                
                return 'en';
            };

            const initialLang = detectUserLanguage();
            console.log(`Detected Language: ${initialLang} (Browser: ${navigator.language})`);

            // 2. Setup State with Detected Language
            const store = new ReactiveStore({
                lang: initialLang,
                filter: 'all'
            });

            // 3. Setup Components
            const components = [
                new NavbarComponent('navbar', container),
                new DirectoryComponent('directory', container),
                new StaticContentComponent(document.body, container),
                new FormManager('register', container)
            ];

            // 4. Setup Router
            const router = new Router();
            router.init();

            // 5. Mount Components
            components.forEach(c => c.mount(store));

            // 6. Define Reactivity
            store.on('stateChange', ({ key, value, state }) => {
                // Update I18n Service if lang changed
                if (key === 'lang') {
                    container.get('i18n').setLanguage(value);
                }
                
                // Trigger Component Updates
                components.forEach(c => c.update(state));
            });

            // 7. Initial Hydration
            store.commit({}); 
            
            // Force initial render with detected language
            container.get('i18n').setLanguage(initialLang);
            components.forEach(c => c.update(store.get()));
            
            // Init Icons
            if (window.lucide) window.lucide.createIcons();

            console.log('App Ready.');
        }
    }

    // Start Engine
    document.addEventListener('DOMContentLoaded', App.init);

    </script>
</body>
</html>
